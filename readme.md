# LeakGAN for text generation

## Реализация
Для реализация полного пайплайна был взят framework [TextBox](https://github.com/RUCAIBox/TextBox/tree/0.2.1) версии 0.2.1 Для его установки пришлось дополнительно установить драйверы под колаб убунту + добавить недостающие библиотеки и что-то сбилдить из бинарников.

## Пайплайн 
Описан для реализации на collab
1. Установки фремворка
2. Подготовка датасета - поэма Пушкина А С "Евгений Онегин" в виде файла `docx`
3. Дробление датасета на части `train` и `test`
4.  Упаковка датасета под формат фремворка TextBox 
5. Настройка параметров конфига для обучение модели LeakGAN
6. Обучение и инференс с подсчетом метрики chrf++
```shell
!python run_textbox.py --model="LeakGAN" --config_files "/content/TextBox/config.yaml" --dataset="Pushkin"
```

## Результат
Результат генерации можно посмотреть в папке`./generated/`
```shell
{
  'chrf++': 
  {
    'precision': 0.1208, 
    'recall': 0.0604, 
    'document-F': 0.0634, 
    'avg-sentence-F': 0.0822, 
    'beta': 3.0
    }
}
```

## Архитектура
![img](https://github.com/CR-Gjx/LeakGAN/raw/master/figures/leakgan.png)

LeakGAN представляет собой комплекс, состоящий из Manager (LSTM) и Worker. Этот подход облегчает протекание информации из дискриминатора. Manager получает высокоуровневые характеристики от дискриминатора и направляет Worker на каждом этапе процесса генерации. Передача информации поддерживается внутренне и служит в качестве руководящей цели для модуля Worker. Worker кодирует текущие сгенерированные слова с использованием LSTM, объединяя это с встраиванием цели для принятия действий на каждом этапе. Такой подход обеспечивает наличие руководящих сигналов не только в конце, но и на протяжении всего процесса генерации, что улучшает общую производительность.

* Использует иерархический генератор с Manager и Worker.
* Использует утечку информации из дискриминативной сети для руководства процессом генерации.
* Демонстрирует эффективность в генерации длинных текстов через обширные эксперименты на синтетических данных и задачах реального мира.
* Неявно изучает структуры предложений без надзора через взаимодействие Manager и Worker.